# æ™ºé“¾åˆ†ææº¯æºå¹³å° - é¡¹ç›®æ€»ç»“

## é¡¹ç›®æ¦‚è¿°

æœ¬é¡¹ç›®æ˜¯å¯¹åŸæœ‰Vue 2 + Spring Boot + Pythonçš„ç½‘ç»œå®‰å…¨åˆ†æå¹³å°è¿›è¡Œçš„å…¨é¢ç°ä»£åŒ–é‡æ„ï¼Œé‡‡ç”¨æœ€æ–°çš„TypeScriptæŠ€æœ¯æ ˆï¼Œå®ç°äº†Webã€ç§»åŠ¨ç«¯å’Œæ¡Œé¢ç«¯çš„å…¨å¹³å°è¦†ç›–ã€‚

## æŠ€æœ¯æ ˆè¯¦æƒ…

### å·²å®‰è£…çš„ç³»ç»Ÿå·¥å…·
- **Node.js**: v25.0.0 (æœ€æ–°ç‰ˆæœ¬)
- **Bun**: v1.3.1 (é«˜æ€§èƒ½JavaScriptè¿è¡Œæ—¶)
- **pnpm**: v10.20.0 (é«˜æ•ˆåŒ…ç®¡ç†å™¨)
- **Rust**: v1.91.0 (Tauriæ¡Œé¢ç«¯éœ€è¦)
- **PostgreSQL**: v17.6 (æœ€æ–°ç‰ˆæœ¬)

### å‰ç«¯æŠ€æœ¯æ ˆ
- **Next.js**: 16.0.1 (æœ€æ–°ï¼Œæ”¯æŒApp Routerå’ŒReact Server Components)
- **React**: 19.2.0 (æœ€æ–°ç‰ˆæœ¬)
- **TypeScript**: 5.9.3
- **Tailwind CSS**: 4.1.16 (æœ€æ–°ç‰ˆæœ¬ï¼ŒåŸå­åŒ–CSS)
- **Lucide React**: ç°ä»£åŒ–å›¾æ ‡åº“
- **React Query**: æ•°æ®è·å–å’ŒçŠ¶æ€ç®¡ç†
- **Zustand**: è½»é‡çº§çŠ¶æ€ç®¡ç†
- **Recharts**: æ•°æ®å¯è§†åŒ–

### ç§»åŠ¨ç«¯æŠ€æœ¯æ ˆ
- **React Native**: 0.76.6 (æœ€æ–°ç‰ˆæœ¬ï¼Œå¯ç”¨Fabricæ¶æ„)
- **Expo SDK**: ~52.0.32 (æœ€æ–°ç‰ˆæœ¬ï¼Œæ”¯æŒ'use dom')
- **React Native Web**: Webä¸åŸç”Ÿç»„ä»¶å¤ç”¨

### æ¡Œé¢ç«¯æŠ€æœ¯æ ˆ
- **Tauri**: 2.x (è½»é‡çº§ï¼Œä½¿ç”¨Rust)
- **Vite**: 6.4.1 (å¿«é€Ÿæ„å»ºå·¥å…·)

### åç«¯/æ•°æ®å±‚
- **PostgreSQL**: 17.6 (å…³ç³»å‹æ•°æ®åº“)
- **Prisma**: 6.18.0 (ç±»å‹å®‰å…¨çš„ORM)
- **Next.js API Routes**: æœåŠ¡ç«¯API
- **Bun**: å¯é€‰çš„é«˜æ€§èƒ½è¿è¡Œæ—¶

### å¼€å‘å·¥å…·
- **Turborepo**: Monorepoæ„å»ºç³»ç»Ÿ
- **pnpm Workspace**: åŒ…ç®¡ç†
- **Prettier**: ä»£ç æ ¼å¼åŒ–

## é¡¹ç›®ç»“æ„

```
zhilian-next/
â”œâ”€â”€ apps/
â”‚   â”œâ”€â”€ web/                 # Next.js Webåº”ç”¨
â”‚   â”‚   â”œâ”€â”€ src/
â”‚   â”‚   â”‚   â”œâ”€â”€ app/         # App Routeré¡µé¢
â”‚   â”‚   â”‚   â”‚   â”œâ”€â”€ api/     # APIè·¯ç”±
â”‚   â”‚   â”‚   â”‚   â”œâ”€â”€ dashboard/ # ä»ªè¡¨æ¿é¡µé¢
â”‚   â”‚   â”‚   â”‚   â””â”€â”€ page.tsx # é¦–é¡µ
â”‚   â”‚   â”‚   â”œâ”€â”€ components/  # Reactç»„ä»¶
â”‚   â”‚   â”‚   â””â”€â”€ lib/         # å·¥å…·å‡½æ•°
â”‚   â”‚   â””â”€â”€ package.json
â”‚   â”œâ”€â”€ mobile/              # React Nativeç§»åŠ¨åº”ç”¨
â”‚   â”‚   â”œâ”€â”€ App.tsx          # åº”ç”¨å…¥å£
â”‚   â”‚   â””â”€â”€ package.json
â”‚   â””â”€â”€ desktop/             # Tauriæ¡Œé¢åº”ç”¨
â”‚       â”œâ”€â”€ src/
â”‚       â”œâ”€â”€ src-tauri/       # Ruståç«¯
â”‚       â””â”€â”€ package.json
â”œâ”€â”€ packages/
â”‚   â”œâ”€â”€ database/            # Prismaæ•°æ®åº“é…ç½®
â”‚   â”‚   â”œâ”€â”€ prisma/
â”‚   â”‚   â”‚   â””â”€â”€ schema.prisma # æ•°æ®åº“æ¨¡å‹
â”‚   â”‚   â””â”€â”€ index.ts         # Prismaå®¢æˆ·ç«¯
â”‚   â”œâ”€â”€ shared/              # å…±äº«ä»£ç 
â”‚   â”‚   â””â”€â”€ src/
â”‚   â”‚       â”œâ”€â”€ types/       # TypeScriptç±»å‹
â”‚   â”‚       â”œâ”€â”€ constants/   # å¸¸é‡
â”‚   â”‚       â”œâ”€â”€ utils/       # å·¥å…·å‡½æ•°
â”‚   â”‚       â””â”€â”€ schemas/     # ZodéªŒè¯æ¨¡å¼
â”‚   â”œâ”€â”€ ui/                  # å…±äº«UIç»„ä»¶ï¼ˆå¾…å¼€å‘ï¼‰
â”‚   â””â”€â”€ config/              # å…±äº«é…ç½®ï¼ˆå¾…å¼€å‘ï¼‰
â”œâ”€â”€ pnpm-workspace.yaml      # pnpmå·¥ä½œåŒºé…ç½®
â”œâ”€â”€ turbo.json               # Turborepoé…ç½®
â””â”€â”€ README.md                # é¡¹ç›®æ–‡æ¡£
```

## å·²å®ç°åŠŸèƒ½

### 1. æ•°æ®åº“å±‚ (packages/database)
- âœ… Prisma Schemaè®¾è®¡
  - User (ç”¨æˆ·è¡¨)
  - Flow (æµé‡è®°å½•è¡¨)
  - Rule (å®‰å…¨è§„åˆ™è¡¨)
  - Alert (å¨èƒå‘Šè­¦è¡¨)
  - HostMetrics (ä¸»æœºç›‘æ§è¡¨)
  - AuditLog (å®¡è®¡æ—¥å¿—è¡¨)
  - SystemConfig (ç³»ç»Ÿé…ç½®è¡¨)
- âœ… PostgreSQLæ•°æ®åº“åˆå§‹åŒ–
- âœ… Prismaå®¢æˆ·ç«¯ç”Ÿæˆ

### 2. å…±äº«åŒ… (packages/shared)
- âœ… TypeScriptç±»å‹å®šä¹‰
  - ç”¨æˆ·ç±»å‹ (User, Role)
  - æµé‡æ•°æ®ç±»å‹ (FlowData, GeoInfo)
  - è§„åˆ™ç±»å‹ (Rule, RuleType, RuleAction)
  - å‘Šè­¦ç±»å‹ (Alert, AlertStatus)
  - ä¸»æœºç›‘æ§ç±»å‹ (HostMetrics, ProcessInfo)
  - APIå“åº”ç±»å‹ (ApiResponse, PaginatedResponse)
  - WebSocketæ¶ˆæ¯ç±»å‹
- âœ… å¸¸é‡å®šä¹‰
  - APIç«¯ç‚¹
  - WebSocketç«¯ç‚¹
  - åˆ†é¡µé»˜è®¤å€¼
  - åè®®ç±»å‹
  - æ”»å‡»ç±»å‹
  - é¢œè‰²ä¸»é¢˜
- âœ… å·¥å…·å‡½æ•°
  - æ ¼å¼åŒ–å‡½æ•° (formatBytes, formatNumber, formatPercent)
  - éªŒè¯å‡½æ•° (isValidIP, isValidPort)
  - å·¥å…·å‡½æ•° (debounce, throttle, deepClone)
  - æ—¶é—´å¤„ç† (formatDate, timeAgo)
  - å“ˆå¸Œè®¡ç®— (simpleHash)
- âœ… ZodéªŒè¯æ¨¡å¼
  - è®¤è¯ç›¸å…³ (login, register)
  - æµé‡æ•°æ® (flow)
  - è§„åˆ™ç®¡ç† (rule, updateRule)
  - å‘Šè­¦ç®¡ç† (updateAlertStatus)
  - æŸ¥è¯¢å‚æ•° (pagination, flowQuery, alertQuery)

### 3. Webåº”ç”¨ (apps/web)
#### é¡µé¢
- âœ… é¦–é¡µ (`/`)
  - ç°ä»£åŒ–æ¸å˜èƒŒæ™¯
  - åŠŸèƒ½ç‰¹æ€§å±•ç¤ºå¡ç‰‡
  - æŠ€æœ¯æ ˆå±•ç¤º
  - å“åº”å¼è®¾è®¡
- âœ… Dashboardå¸ƒå±€ (`/dashboard`)
  - ä¾§è¾¹æ å¯¼èˆª
  - å“åº”å¼å¸ƒå±€
  - æ·±è‰²æ¨¡å¼æ”¯æŒ
- âœ… Dashboardæ€»è§ˆ (`/dashboard`)
  - ç»Ÿè®¡å¡ç‰‡ (æ€»æµé‡ã€æ´»è·ƒå‘Šè­¦ã€å®‰å…¨è§„åˆ™ã€ç³»ç»Ÿå¥åº·åº¦)
  - æœ€æ–°å‘Šè­¦åˆ—è¡¨
  - å›¾è¡¨å ä½ç¬¦

#### APIè·¯ç”±
- âœ… `/api/stats/dashboard` - ä»ªè¡¨æ¿ç»Ÿè®¡
- âœ… `/api/flows` - æµé‡è®°å½•CRUD
- âœ… `/api/alerts` - å‘Šè­¦è®°å½•CRUD
- âœ… `/api/rules` - è§„åˆ™ç®¡ç†CRUD
- âœ… `/api/rules/[id]` - å•ä¸ªè§„åˆ™æ“ä½œ
- âœ… `/api/host/metrics` - ä¸»æœºç›‘æ§æŒ‡æ ‡

#### ç»„ä»¶
- âœ… UIç»„ä»¶ (Cardç³»åˆ—)
- âœ… å¸ƒå±€ç»„ä»¶
- âœ… ç»Ÿè®¡å¡ç‰‡ç»„ä»¶
- âœ… å‘Šè­¦é¡¹ç»„ä»¶

### 4. ç§»åŠ¨åº”ç”¨ (apps/mobile)
- âœ… Expoé¡¹ç›®åˆå§‹åŒ–
- âœ… åŸºç¡€UIç•Œé¢
- âœ… åŠŸèƒ½ç‰¹æ€§å¡ç‰‡å±•ç¤º
- âœ… æš—è‰²ä¸»é¢˜

### 5. æ¡Œé¢åº”ç”¨ (apps/desktop)
- âœ… Taurié¡¹ç›®åˆå§‹åŒ–
- âœ… Viteæ„å»ºé…ç½®
- âœ… ç³»ç»Ÿä¾èµ–å®‰è£… (webkit2gtk, librsvg2ç­‰)

## æ ¸å¿ƒåŠŸèƒ½æ˜ å°„

### åŸé¡¹ç›® â†’ æ–°é¡¹ç›®
1. **æµé‡åˆ†æ**
   - åŸ: Vueç»„ä»¶ + Javaåç«¯ + Pythonåˆ†æ
   - æ–°: Next.js Reactç»„ä»¶ + API Routes + PostgreSQL

2. **ä¸»æœºç›‘æ§**
   - åŸ: WebSocketå®æ—¶æ¨é€
   - æ–°: SSE/WebSocket + React Queryå®æ—¶æ›´æ–°

3. **å¨èƒå‘Šè­¦**
   - åŸ: MySQL + Redisç¼“å­˜
   - æ–°: PostgreSQL + Prisma + æœåŠ¡ç«¯ç¼“å­˜

4. **è§„åˆ™ç®¡ç†**
   - åŸ: Spring Boot CRUD
   - æ–°: Next.js API Routes + Prisma

5. **åŒºå—é“¾å­˜è¯**
   - åŸ: Hyperledger Fabric
   - æ–°: PostgreSQLå®¡è®¡æ—¥å¿—è¡¨ (ä½¿ç”¨å“ˆå¸Œé“¾)

## è®¾è®¡ä¼˜åŠ¿

### 1. æ€§èƒ½ä¼˜åŒ–
- **Next.js App Router**: 
  - æœåŠ¡ç«¯ç»„ä»¶å‡å°‘å®¢æˆ·ç«¯JavaScript
  - è‡ªåŠ¨ä»£ç åˆ†å‰²
  - å¢é‡é™æ€ç”Ÿæˆ
- **Bunè¿è¡Œæ—¶**: æ¯”Node.jså¿«3-4å€
- **Prisma ORM**: ç±»å‹å®‰å…¨çš„æ•°æ®åº“è®¿é—®
- **pnpm**: ç£ç›˜ç©ºé—´èŠ‚çœé«˜è¾¾40%

### 2. å¼€å‘ä½“éªŒ
- **TypeScriptå…¨æ ˆ**: ç«¯åˆ°ç«¯ç±»å‹å®‰å…¨
- **Monorepo**: ä»£ç å¤ç”¨ï¼Œç»Ÿä¸€ç®¡ç†
- **Hot Module Replacement**: ç§’çº§çƒ­æ›´æ–°
- **Turboæ„å»º**: å¹¶è¡Œæ„å»ºï¼Œæ™ºèƒ½ç¼“å­˜

### 3. å¯ç»´æŠ¤æ€§
- **æ¸…æ™°çš„é¡¹ç›®ç»“æ„**: æŒ‰åŠŸèƒ½æ¨¡å—åŒ–
- **å…±äº«åŒ…**: é¿å…ä»£ç é‡å¤
- **ç±»å‹å®‰å…¨**: ç¼–è¯‘æ—¶é”™è¯¯æ£€æŸ¥
- **ç°ä»£åŒ–å·¥å…·é“¾**: æœ€ä½³å®è·µ

### 4. å¯æ‰©å±•æ€§
- **API Routes**: æ˜“äºæ·»åŠ æ–°ç«¯ç‚¹
- **Prisma Schema**: æ•°æ®åº“è¿ç§»ç®¡ç†
- **ç»„ä»¶åŒ–è®¾è®¡**: æ˜“äºå¤ç”¨å’Œæ‰©å±•
- **è·¨å¹³å°æ”¯æŒ**: Web + ç§»åŠ¨ + æ¡Œé¢

## æ•°æ®åº“æ¨¡å‹

### æ ¸å¿ƒè¡¨
1. **users** - ç”¨æˆ·è®¤è¯å’Œæˆæƒ
2. **flows** - ç½‘ç»œæµé‡è®°å½•
3. **rules** - å®‰å…¨è§„åˆ™é…ç½®
4. **alerts** - å¨èƒå‘Šè­¦è®°å½•
5. **host_metrics** - ä¸»æœºæ€§èƒ½æŒ‡æ ‡
6. **audit_logs** - å®¡è®¡æ—¥å¿—ï¼ˆåŒºå—é“¾å¼ï¼‰
7. **system_configs** - ç³»ç»Ÿé…ç½®

### ç´¢å¼•ä¼˜åŒ–
- æ—¶é—´æˆ³ç´¢å¼• (flows, alerts, host_metrics)
- IPåœ°å€ç´¢å¼• (flows)
- çŠ¶æ€ç´¢å¼• (alerts, rules)
- ç”¨æˆ·IDç´¢å¼• (audit_logs)

## å¾…å®ŒæˆåŠŸèƒ½

### é«˜ä¼˜å…ˆçº§
1. â³ WebSocket/SSEå®æ—¶æ•°æ®æ¨é€
2. â³ æµé‡åˆ†æé¡µé¢å®Œæ•´å®ç°
3. â³ å‘Šè­¦ç®¡ç†é¡µé¢
4. â³ è§„åˆ™ç®¡ç†é¡µé¢
5. â³ ä¸»æœºç›‘æ§é¡µé¢
6. â³ ç”¨æˆ·è®¤è¯ç³»ç»Ÿ

### ä¸­ä¼˜å…ˆçº§
1. â³ æ•°æ®å¯è§†åŒ–å›¾è¡¨ (ä½¿ç”¨Recharts)
2. â³ æ–‡ä»¶ä¸Šä¼ åŠŸèƒ½ (PCAP/CSV)
3. â³ åœ°ç†ä½ç½®å±•ç¤º (ä¸­å›½åœ°å›¾)
4. â³ ç§»åŠ¨ç«¯å®Œæ•´åŠŸèƒ½
5. â³ æ¡Œé¢ç«¯å®Œæ•´åŠŸèƒ½

### ä½ä¼˜å…ˆçº§
1. â³ å›½é™…åŒ–æ”¯æŒ
2. â³ ä¸»é¢˜åˆ‡æ¢
3. â³ æ€§èƒ½ä¼˜åŒ–
4. â³ å•å…ƒæµ‹è¯•
5. â³ E2Eæµ‹è¯•

## éƒ¨ç½²æ–¹æ¡ˆ

### å¼€å‘ç¯å¢ƒ
```bash
# å®‰è£…ä¾èµ–
pnpm install

# é…ç½®æ•°æ®åº“
cd packages/database
cp .env.example .env
# ç¼–è¾‘.envè®¾ç½®DATABASE_URL
pnpm db:push

# å¯åŠ¨å¼€å‘æœåŠ¡å™¨
pnpm dev
```

### ç”Ÿäº§éƒ¨ç½²é€‰é¡¹

#### 1. Cloudflare Pages (æ¨è)
- å…¨çƒCDN
- è‡ªåŠ¨HTTPS
- é›¶é…ç½®éƒ¨ç½²
- Serverless Functions

#### 2. Dockerå®¹å™¨
```dockerfile
# å¤šé˜¶æ®µæ„å»º
FROM node:25-alpine AS builder
# ... æ„å»ºæ­¥éª¤

FROM node:25-alpine
# ... è¿è¡Œæ—¶é…ç½®
```

#### 3. ä¼ ç»ŸVPS
- Nginxåå‘ä»£ç†
- PM2è¿›ç¨‹ç®¡ç†
- PostgreSQLæ•°æ®åº“
- Redisç¼“å­˜

## æ€§èƒ½æŒ‡æ ‡ç›®æ ‡

- **é¦–å±åŠ è½½**: < 1.5s
- **APIå“åº”**: < 200ms
- **æ•°æ®åº“æŸ¥è¯¢**: < 50ms
- **WebSocketå»¶è¿Ÿ**: < 100ms
- **ç§»åŠ¨ç«¯FPS**: > 55
- **æ¡Œé¢ç«¯å†…å­˜**: < 100MB

## å®‰å…¨ç‰¹æ€§

1. **SQLæ³¨å…¥é˜²æŠ¤**: Prismaå‚æ•°åŒ–æŸ¥è¯¢
2. **XSSé˜²æŠ¤**: Reactè‡ªåŠ¨è½¬ä¹‰
3. **CSRFé˜²æŠ¤**: SameSite Cookie
4. **è¾“å…¥éªŒè¯**: Zod schemaéªŒè¯
5. **å®¡è®¡æ—¥å¿—**: æ‰€æœ‰æ“ä½œè®°å½•
6. **å¯†ç åŠ å¯†**: bcrypt/argon2
7. **JWTè®¤è¯**: æ— çŠ¶æ€ä¼šè¯

## æœªæ¥è§„åˆ’

### çŸ­æœŸ (1-3ä¸ªæœˆ)
- å®Œæˆæ ¸å¿ƒä¸šåŠ¡åŠŸèƒ½
- å®ç°å®æ—¶æ•°æ®æ¨é€
- ç§»åŠ¨ç«¯åŸºç¡€åŠŸèƒ½
- æ¡Œé¢ç«¯åŸºç¡€åŠŸèƒ½
- å•å…ƒæµ‹è¯•è¦†ç›–

### ä¸­æœŸ (3-6ä¸ªæœˆ)
- AIå¨èƒåˆ†æé›†æˆ
- é«˜çº§æ•°æ®å¯è§†åŒ–
- æ€§èƒ½ä¼˜åŒ–
- å¤šç§Ÿæˆ·æ”¯æŒ
- æ’ä»¶ç³»ç»Ÿ

### é•¿æœŸ (6-12ä¸ªæœˆ)
- è¾¹ç¼˜è®¡ç®—æ”¯æŒ
- åˆ†å¸ƒå¼è¿½è¸ª
- æœºå™¨å­¦ä¹ æ¨¡å‹ä¼˜åŒ–
- å›½é™…åŒ–
- ç¤¾åŒºç‰ˆæœ¬

## æŠ€æœ¯å€ºåŠ¡

1. ç§»åŠ¨ç«¯Reactç‰ˆæœ¬å†²çªéœ€è¦è§£å†³
2. CSSä¸»é¢˜ç³»ç»Ÿéœ€è¦ç»Ÿä¸€
3. APIé”™è¯¯å¤„ç†éœ€è¦æ ‡å‡†åŒ–
4. æ—¥å¿—ç³»ç»Ÿéœ€è¦å®Œå–„
5. ç›‘æ§å’Œå‘Šè­¦éœ€è¦é›†æˆ

## è´¡çŒ®æŒ‡å—

1. Forké¡¹ç›®
2. åˆ›å»ºåŠŸèƒ½åˆ†æ”¯ (`git checkout -b feature/AmazingFeature`)
3. æäº¤æ›´æ”¹ (`git commit -m 'Add some AmazingFeature'`)
4. æ¨é€åˆ°åˆ†æ”¯ (`git push origin feature/AmazingFeature`)
5. å¼€å¯Pull Request

## è®¸å¯è¯

MIT License - è¯¦è§LICENSEæ–‡ä»¶

## è”ç³»æ–¹å¼

- é¡¹ç›®ä¸»é¡µ: [GitHubåœ°å€]
- é—®é¢˜åé¦ˆ: [Issuesé¡µé¢]
- æ–‡æ¡£: [åœ¨çº¿æ–‡æ¡£]

---

**æœ€åæ›´æ–°**: 2025-10-31
**ç‰ˆæœ¬**: 1.0.0
**çŠ¶æ€**: å¼€å‘ä¸­ ğŸš§

